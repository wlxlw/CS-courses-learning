# 任务要求

实现copy-on-write fork。以为fork系统调用会复制父进程的所有空间内容到子进程，如果父进程占用的空间很大，这一复制过程会占用很长的时间。而且在fork系统调用之后，经常会调用exec系统调用，子进程会丢弃刚刚从父进程那里获得的内存内容

copy-on-write (COW) fork会推迟"复制父进程的物理页到子进程"，直到子进程真的需要此操作

COW fork直接给子进程创建一个页表，

COW fork

1. 父进程和子进程最初共享物理页，但是都不允许写操作(页表项的PTE_W为0)
2. 如果父进程(或者子进程)需要写页表
   1. RISC-V CPU会产生一个page-fault exception。
   2. trap处理程序会分配一个新的物理页，并复制进程希望写的物理页的内容到新的物理页。
   3. 内核也会修改页表项指向新的物理页，并且允许写操作。
   4. 恢复到产生page-fault exception的指令处执行
3. 如果父进程(或者子进程)需要读页表，正常读



